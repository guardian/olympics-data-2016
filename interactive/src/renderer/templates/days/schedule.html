<div class="om-section om-section--divider">
    <div class="om-section__title">
        <h3 class="om-schedule-date">
            <time datetime="{{ schedule.day.date }}">
                {{ schedule.day.date|datefmt('dddd') }},
                <span>{{ schedule.day.date|datefmt('D MMM') }}</span>
            </time>
        </h3>
        <p class="om-schedule-date-no">
            Day {{ schedule.day.dateNo + 1 }} of {{ scheduleByDay.length }}
        </p>
    </div>

    {% if view === 'results' %}
        <!-- weird hack without which state-mutating reverse filter would get applied even in else case -->
        {% set disciplines = Array.from(schedule.disciplines) | sortDisciplines %}
    {% else %}
        {% set disciplines = schedule.disciplines %}
    {% endif %}

    {% for discipline in disciplines %}
        <div class="om-discipline js-discipline" data-discipline="{{ discipline.identifier }}" >
            <h4 class="om-discipline__name">{{ discipline.description }}</h4>
            {% if discipline.venues.length === 1 %}
                <p class="om-discipline__venue">{{ discipline.venues[0].name }}</p>
            {% else %}
                <p class="om-discipline__venue">Multiple venues</p>
            {% endif %}
            <ul class="om-events">
                {% for event in discipline.events|sortEvents(view) %}
                    <li class="om-event {% if event.status === 'Finished' %}om-event--finished{% endif %}">
                        <time class="om-event__time" datetime="{{ event.start }}">
                            {{ event.start|datefmt('HH:mm') }}
                        </time>
                        <span class="om-event__name">
                            {{ event.description }}
                            {% if event.group.length > 1 %}
                                <span class="om-event__name__events">({{ event.group.length }} events)</span>
                            {% endif %}
                        </span>
                        <span class="om-event__id">{{ event.unit.identifier }}</span>
                        {% for subEvent in event.group  %}
                            {% set result = results[subEvent.unit.identifier] %}
                            {% if result %}
                                <div class="om-event__result">
                                    {% if event.group.length > 1 %}
                                        <span class="om-event__sub-name">{{ subEvent.description }}</span>
                                    {% endif %}
                                    {% include '_result.html' {'result': result} %}
                                </div>
                            {% endif %}
                        {% endfor %}
                        <div class="om-event__clicker js-expand-results"></div>
                        <div class="om-event__expand"></div>
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% endfor %}
</div>
